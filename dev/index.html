<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · FixedMeshRefinement.jl</title><meta name="title" content="Home · FixedMeshRefinement.jl"/><meta property="og:title" content="Home · FixedMeshRefinement.jl"/><meta property="twitter:title" content="Home · FixedMeshRefinement.jl"/><meta name="description" content="Documentation for FixedMeshRefinement.jl."/><meta property="og:description" content="Documentation for FixedMeshRefinement.jl."/><meta property="twitter:description" content="Documentation for FixedMeshRefinement.jl."/><meta property="og:url" content="https://AuroraDysis.github.io/FixedMeshRefinement.jl/"/><meta property="twitter:url" content="https://AuroraDysis.github.io/FixedMeshRefinement.jl/"/><link rel="canonical" href="https://AuroraDysis.github.io/FixedMeshRefinement.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>FixedMeshRefinement.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="FixedMeshRefinement"><a class="docs-heading-anchor" href="#FixedMeshRefinement">FixedMeshRefinement</a><a id="FixedMeshRefinement-1"></a><a class="docs-heading-anchor-permalink" href="#FixedMeshRefinement" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/AuroraDysis/FixedMeshRefinement.jl">FixedMeshRefinement</a>.</p><ul><li><a href="#FixedMeshRefinement.Grid"><code>FixedMeshRefinement.Grid</code></a></li><li><a href="#FixedMeshRefinement.Level"><code>FixedMeshRefinement.Level</code></a></li><li><a href="#Base.show-Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Grid}"><code>Base.show</code></a></li><li><a href="#Base.show-Tuple{IO, Grid}"><code>Base.show</code></a></li><li><a href="#Base.show-Tuple{IO, Level}"><code>Base.show</code></a></li><li><a href="#Base.show-Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Level}"><code>Base.show</code></a></li><li><a href="#FixedMeshRefinement.apply_transition_zone!-Tuple{Grid, Int64, Bool}"><code>FixedMeshRefinement.apply_transition_zone!</code></a></li><li><a href="#FixedMeshRefinement.calc_Yn_from_kcs!-Tuple{Any, Any, Any, Any, Bool, Any}"><code>FixedMeshRefinement.calc_Yn_from_kcs!</code></a></li><li><a href="#FixedMeshRefinement.cycle_state!-Tuple{Level}"><code>FixedMeshRefinement.cycle_state!</code></a></li><li><a href="#FixedMeshRefinement.fill_buffer!-Tuple{Any, Level, Int64}"><code>FixedMeshRefinement.fill_buffer!</code></a></li><li><a href="#FixedMeshRefinement.fine_to_coarse_index-Tuple{Level, Int64}"><code>FixedMeshRefinement.fine_to_coarse_index</code></a></li><li><a href="#FixedMeshRefinement.get_boundary_indices-Tuple{Level}"><code>FixedMeshRefinement.get_boundary_indices</code></a></li><li><a href="#FixedMeshRefinement.get_diagnostic_state-Tuple{Level}"><code>FixedMeshRefinement.get_diagnostic_state</code></a></li><li><a href="#FixedMeshRefinement.get_interior_indices-Tuple{Level}"><code>FixedMeshRefinement.get_interior_indices</code></a></li><li><a href="#FixedMeshRefinement.get_maximum_grid_points-Tuple{Level}"><code>FixedMeshRefinement.get_maximum_grid_points</code></a></li><li><a href="#FixedMeshRefinement.get_offset_indices-Tuple{Level}"><code>FixedMeshRefinement.get_offset_indices</code></a></li><li><a href="#FixedMeshRefinement.get_rhs_evaluation_indices-Tuple{Level}"><code>FixedMeshRefinement.get_rhs_evaluation_indices</code></a></li><li><a href="#FixedMeshRefinement.get_rk4_evaluation_indices-Tuple{Level}"><code>FixedMeshRefinement.get_rk4_evaluation_indices</code></a></li><li><a href="#FixedMeshRefinement.get_rk4_tmp_state-Tuple{Level}"><code>FixedMeshRefinement.get_rk4_tmp_state</code></a></li><li><a href="#FixedMeshRefinement.get_rk_stage-Tuple{Level, Int64}"><code>FixedMeshRefinement.get_rk_stage</code></a></li><li><a href="#FixedMeshRefinement.get_state"><code>FixedMeshRefinement.get_state</code></a></li><li><a href="#FixedMeshRefinement.get_tmp_state-Tuple{Level}"><code>FixedMeshRefinement.get_tmp_state</code></a></li><li><a href="#FixedMeshRefinement.get_total_grid_points-Tuple{Level}"><code>FixedMeshRefinement.get_total_grid_points</code></a></li><li><a href="#FixedMeshRefinement.get_x-Tuple{Level}"><code>FixedMeshRefinement.get_x</code></a></li><li><a href="#FixedMeshRefinement.integrate_simpson-Tuple{Grid, Function}"><code>FixedMeshRefinement.integrate_simpson</code></a></li><li><a href="#FixedMeshRefinement.integrate_trapezoidal-Tuple{Grid, Function}"><code>FixedMeshRefinement.integrate_trapezoidal</code></a></li><li><a href="#FixedMeshRefinement.merge_grid_levels-Tuple{Grid, Function}"><code>FixedMeshRefinement.merge_grid_levels</code></a></li><li><a href="#FixedMeshRefinement.prolongate!-Tuple{Grid, Int64, Bool}"><code>FixedMeshRefinement.prolongate!</code></a></li><li><a href="#FixedMeshRefinement.prolongate_mongwane!-Tuple{Grid, Int64, Bool}"><code>FixedMeshRefinement.prolongate_mongwane!</code></a></li><li><a href="#FixedMeshRefinement.restrict_injection!-Tuple{Grid, Int64}"><code>FixedMeshRefinement.restrict_injection!</code></a></li><li><a href="#FixedMeshRefinement.rk4!-Tuple{Level, Function, Any}"><code>FixedMeshRefinement.rk4!</code></a></li><li><a href="#FixedMeshRefinement.rk4_dense_output_y!-NTuple{5, Any}"><code>FixedMeshRefinement.rk4_dense_output_y!</code></a></li><li><a href="#FixedMeshRefinement.searchsortednearest-Tuple{AbstractVector, Any}"><code>FixedMeshRefinement.searchsortednearest</code></a></li><li><a href="#FixedMeshRefinement.shift_grid_boundaries!-Tuple{Grid, Tuple{Int64, Int64}}"><code>FixedMeshRefinement.shift_grid_boundaries!</code></a></li><li><a href="#FixedMeshRefinement.shift_level_boundaries!-Tuple{Grid, Int64, Tuple{Int64, Int64}}"><code>FixedMeshRefinement.shift_level_boundaries!</code></a></li><li><a href="#FixedMeshRefinement.spatial_interpolate!-NTuple{4, Any}"><code>FixedMeshRefinement.spatial_interpolate!</code></a></li><li><a href="#FixedMeshRefinement.step!-Tuple{Grid, Function, Any}"><code>FixedMeshRefinement.step!</code></a></li><li><a href="#FixedMeshRefinement.time_interpolate!-Tuple{Any, Any, Any}"><code>FixedMeshRefinement.time_interpolate!</code></a></li><li><a href="#FixedMeshRefinement.transition_profile-Tuple{Any, Any, Any}"><code>FixedMeshRefinement.transition_profile</code></a></li><li><a href="#FixedMeshRefinement.typetol-Tuple{Type{&lt;:AbstractFloat}}"><code>FixedMeshRefinement.typetol</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.Grid" href="#FixedMeshRefinement.Grid"><code>FixedMeshRefinement.Grid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Grid</code></pre><p>A struct representing the entire FMR grid, which consists of multiple <code>Level</code>s.</p><p><strong>Fields</strong></p><ul><li><code>levels::Vector{Level}</code>: A vector of <code>Level</code> objects.</li><li><code>base_dt::Float64</code>: The time step of the coarsest level.</li><li><code>t::Float64</code>: The current time of the simulation.</li><li><code>subcycling::Bool</code>: A boolean indicating whether subcycling in time is enabled.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L362-L373">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.Level" href="#FixedMeshRefinement.Level"><code>FixedMeshRefinement.Level</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Level</code></pre><p>A struct representing a single refinement level in the mesh.</p><p><strong>Fields</strong></p><ul><li><code>index::Int</code>: Index of the level.</li><li><code>num_state_variables::Int</code>: Number of state variables.</li><li><code>num_diagnostic_variables::Int</code>: Number of diagnostic variables.</li><li><code>num_tmp_variables::Int</code>: Number of temporary variables.</li><li><code>num_interior_points::Int</code>: Number of interior grid points.</li><li><code>num_ghost_points::Int</code>: Number of ghost points on each side.</li><li><code>num_buffer_points::Int</code>: Number of buffer points on each side for inter-level communication.</li><li><code>num_transition_points::NTuple{2,Int}</code>: Number of points in the transition zone for mesh refinement.</li><li><code>num_boundary_points::NTuple{2,Int}</code>: Number of boundary points on each side (ghost or buffer).</li><li><code>time_interpolation_order::Int</code>: Order of time interpolation.</li><li><code>spatial_interpolation_order::Int</code>: Order of spatial interpolation.</li><li><code>domain_box::Tuple{Float64,Float64}</code>: The computational domain (interior) of this level.</li><li><code>physical_domain_box::Tuple{Float64,Float64}</code>: The physical domain of the entire grid.</li><li><code>is_physical_boundary::NTuple{2,Bool}</code>: Indicates if the level boundaries are physical boundaries.</li><li><code>dx::Float64</code>: Grid spacing.</li><li><code>dt::Float64</code>: Time step.</li><li><code>t::Float64</code>: Current time of this level.</li><li><code>parent_indices::UnitRange{Int}</code>: Range of indices of the parent level that this level covers.</li><li><code>offset_indices::UnitRange{Int}</code>: Range of indices for <code>OffsetArray</code>s of this level.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L38-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.show-Tuple{IO, Grid}" href="#Base.show-Tuple{IO, Grid}"><code>Base.show</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.show(io::IO, grid::Grid)</code></pre><p>Display a compact summary of the <code>Grid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L573-L577">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.show-Tuple{IO, Level}" href="#Base.show-Tuple{IO, Level}"><code>Base.show</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.show(io::IO, level::Level)</code></pre><p>Display a compact summary of the <code>Level</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L599-L603">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.show-Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Grid}" href="#Base.show-Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Grid}"><code>Base.show</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.show(io::IO, ::MIME&quot;text/plain&quot;, grid::Grid)</code></pre><p>Display a detailed summary of the <code>Grid</code> structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L583-L587">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.show-Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Level}" href="#Base.show-Tuple{IO, MIME{Symbol(&quot;text/plain&quot;)}, Level}"><code>Base.show</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Base.show(io::IO, ::MIME&quot;text/plain&quot;, level::Level)</code></pre><p>Display a detailed summary of the <code>Level</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L619-L623">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.apply_transition_zone!-Tuple{Grid, Int64, Bool}" href="#FixedMeshRefinement.apply_transition_zone!-Tuple{Grid, Int64, Bool}"><code>FixedMeshRefinement.apply_transition_zone!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_transition_zone!(grid::Grid, l::Int, interp_in_time::Bool)</code></pre><p>Apply a transition zone to smoothly connect coarse and fine grid solutions at the boundaries of a refinement level. This function blends the fine grid solution with a prolonged solution from the coarse grid.</p><p><strong>Arguments</strong></p><ul><li><code>grid::Grid</code>: The grid structure.</li><li><code>l::Int</code>: The fine level index.</li><li><code>interp_in_time::Bool</code>: Whether to use time interpolation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/prolongation.jl#L182-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.calc_Yn_from_kcs!-Tuple{Any, Any, Any, Any, Bool, Any}" href="#FixedMeshRefinement.calc_Yn_from_kcs!-Tuple{Any, Any, Any, Any, Bool, Any}"><code>FixedMeshRefinement.calc_Yn_from_kcs!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_Yn_from_kcs!(Yn_buffer, yn, kcs, dtc, interp_in_time, dytmp)</code></pre><p>Calculate the intermediate <code>Y</code> values needed for Mongwane&#39;s subcycling method. These values represent the state on the coarse grid at intermediate times required by the fine grid&#39;s time stepping.</p><p><strong>Arguments</strong></p><ul><li><code>Yn_buffer</code>: Buffer to store the calculated <code>Y</code> values.</li><li><code>yn</code>: State on the coarse grid at the beginning of the step.</li><li><code>kcs</code>: The RK4 stages from the coarse grid time step.</li><li><code>dtc::Float64</code>: The coarse grid time step.</li><li><code>interp_in_time::Bool</code>: Flag indicating if interpolation in time is needed.</li><li><code>dytmp</code>: Temporary storage for derivatives.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/prolongation.jl#L90-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.cycle_state!-Tuple{Level}" href="#FixedMeshRefinement.cycle_state!-Tuple{Level}"><code>FixedMeshRefinement.cycle_state!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cycle_state!(level::Level)</code></pre><p>Shift the time levels of the state variables in a <code>Level</code>. <code>state[i]</code> becomes <code>state[i+1]</code>. This is used to advance the solution in time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L319-L324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.fill_buffer!-Tuple{Any, Level, Int64}" href="#FixedMeshRefinement.fill_buffer!-Tuple{Any, Level, Int64}"><code>FixedMeshRefinement.fill_buffer!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fill_buffer!(u, level::Level, stage::Int)</code></pre><p>Fill the ghost cells of the solution array <code>u</code> from the <code>Yn_buffer</code> at a specific Runge-Kutta <code>stage</code>. This is part of the subcycling-in-time method. After copying, the buffer is filled with <code>NaN</code> to avoid accidental reuse.</p><p><strong>Arguments</strong></p><ul><li><code>u</code>: The solution array with ghost cells to be filled.</li><li><code>level::Level</code>: The grid level.</li><li><code>stage::Int</code>: The RK stage index.</li><li><code>fill_with_nan::Bool</code>: If <code>true</code>, fill the buffer with <code>NaN</code> to avoid accidental reuse. Defaults to <code>true</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/rk.jl#L3-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.fine_to_coarse_index-Tuple{Level, Int64}" href="#FixedMeshRefinement.fine_to_coarse_index-Tuple{Level, Int64}"><code>FixedMeshRefinement.fine_to_coarse_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fine_to_coarse_index(fine_level::Level, fidx::Int) -&gt; Int</code></pre><p>Convert a fine grid index <code>fidx</code> to the corresponding coarse grid index. This function is not defined for the base level. An error is thrown if the fine grid point does not align with any coarse grid point.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L334-L340">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_boundary_indices-Tuple{Level}" href="#FixedMeshRefinement.get_boundary_indices-Tuple{Level}"><code>FixedMeshRefinement.get_boundary_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_boundary_indices(level::Level) -&gt; NTuple{2,StepRange{Int,Int}}</code></pre><p>Return the indices of the boundary points on each side (ghost or buffer).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L214-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_diagnostic_state-Tuple{Level}" href="#FixedMeshRefinement.get_diagnostic_state-Tuple{Level}"><code>FixedMeshRefinement.get_diagnostic_state</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_diagnostic_state(level::Level)</code></pre><p>Return the diagnostic state variables of the <code>level</code> as an <code>OffsetArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L299-L303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_interior_indices-Tuple{Level}" href="#FixedMeshRefinement.get_interior_indices-Tuple{Level}"><code>FixedMeshRefinement.get_interior_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_interior_indices(level::Level) -&gt; UnitRange{Int}</code></pre><p>Return the indices of the interior grid points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L204-L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_maximum_grid_points-Tuple{Level}" href="#FixedMeshRefinement.get_maximum_grid_points-Tuple{Level}"><code>FixedMeshRefinement.get_maximum_grid_points</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_maximum_grid_points(level::Level) -&gt; Int</code></pre><p>Return the maximum number of grid points at this level (including ghost, buffer and unused points).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L246-L250">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_offset_indices-Tuple{Level}" href="#FixedMeshRefinement.get_offset_indices-Tuple{Level}"><code>FixedMeshRefinement.get_offset_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_offset_indices(level::Level) -&gt; UnitRange{Int}</code></pre><p>Return the indices of the grid points in the <code>OffsetArray</code> of the <code>level</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L227-L231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_rhs_evaluation_indices-Tuple{Level}" href="#FixedMeshRefinement.get_rhs_evaluation_indices-Tuple{Level}"><code>FixedMeshRefinement.get_rhs_evaluation_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_rhs_evaluation_indices(level::Level) -&gt; UnitRange{Int}</code></pre><p>Return the indices that requires evaluation of the right-hand side.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L194-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_rk4_evaluation_indices-Tuple{Level}" href="#FixedMeshRefinement.get_rk4_evaluation_indices-Tuple{Level}"><code>FixedMeshRefinement.get_rk4_evaluation_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_rk4_evaluation_indices(level::Level) -&gt; UnitRange{Int}</code></pre><p>Return the indices that requires evaluation of the RK4 stages.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L184-L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_rk4_tmp_state-Tuple{Level}" href="#FixedMeshRefinement.get_rk4_tmp_state-Tuple{Level}"><code>FixedMeshRefinement.get_rk4_tmp_state</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_rk4_tmp_state(level::Level)</code></pre><p>Return a temporary array with the same size as the state variables of the <code>level</code> as an <code>OffsetArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L277-L282">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_rk_stage-Tuple{Level, Int64}" href="#FixedMeshRefinement.get_rk_stage-Tuple{Level, Int64}"><code>FixedMeshRefinement.get_rk_stage</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_rk_stage(level::Level, i::Int)</code></pre><p>Return the <code>i</code>-th intermediate state <code>k_i</code> for the Runge-Kutta time stepping scheme as an <code>OffsetArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L288-L293">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_state" href="#FixedMeshRefinement.get_state"><code>FixedMeshRefinement.get_state</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_state(level::Level, i::Int=0)</code></pre><p>Return the state variables of the <code>level</code> as an <code>OffsetArray</code>. The optional argument <code>i</code> specifies the time level, where <code>i=0</code> corresponds to the current time level <code>n</code>, <code>i=-1</code> to <code>n-1</code>, etc.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L265-L271">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_tmp_state-Tuple{Level}" href="#FixedMeshRefinement.get_tmp_state-Tuple{Level}"><code>FixedMeshRefinement.get_tmp_state</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_tmp_state(level::Level)</code></pre><p>Return the temporary state variables of the <code>level</code> as an <code>OffsetArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L309-L313">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_total_grid_points-Tuple{Level}" href="#FixedMeshRefinement.get_total_grid_points-Tuple{Level}"><code>FixedMeshRefinement.get_total_grid_points</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_total_grid_points(level::Level) -&gt; Int</code></pre><p>Return the total number of grid points at this level (including ghost and buffer points).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L236-L240">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.get_x-Tuple{Level}" href="#FixedMeshRefinement.get_x-Tuple{Level}"><code>FixedMeshRefinement.get_x</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_x(level::Level)</code></pre><p>Return the grid point coordinates of the <code>level</code> as an <code>OffsetArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L255-L259">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.integrate_simpson-Tuple{Grid, Function}" href="#FixedMeshRefinement.integrate_simpson-Tuple{Grid, Function}"><code>FixedMeshRefinement.integrate_simpson</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_simpson(grid::Grid, getter::Function)</code></pre><p>Integrate a variable over all levels of the grid using Simpson&#39;s rule. The <code>getter</code> function specifies which data to retrieve the data of the variable from each level. <code>getter(level)</code> should return an <code>SubArray</code> of <code>OffsetArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/integrate.jl#L51-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.integrate_trapezoidal-Tuple{Grid, Function}" href="#FixedMeshRefinement.integrate_trapezoidal-Tuple{Grid, Function}"><code>FixedMeshRefinement.integrate_trapezoidal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrate_trapezoidal(grid::Grid, getter::Function)</code></pre><p>Integrate a variable over all levels of the grid using the trapezoidal rule. The <code>getter</code> function specifies which data to retrieve the data of the variable from each level. <code>getter(level)</code> should return an <code>SubArray</code> of <code>OffsetArray</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/integrate.jl#L29-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.merge_grid_levels-Tuple{Grid, Function}" href="#FixedMeshRefinement.merge_grid_levels-Tuple{Grid, Function}"><code>FixedMeshRefinement.merge_grid_levels</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_grid_levels(grid::Grid, getter::Function)</code></pre><p>Merge signle variable from all levels of the grid into a <code>BlockArray</code>. The <code>getter</code> function specifies which data to retrieve the data of the variable from each level. <code>getter(level)</code> should return a <code>SubArray</code> of <code>OffsetArray</code> from which data is read.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/merge.jl#L3-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.prolongate!-Tuple{Grid, Int64, Bool}" href="#FixedMeshRefinement.prolongate!-Tuple{Grid, Int64, Bool}"><code>FixedMeshRefinement.prolongate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prolongate!(grid::Grid, l::Int, interp_in_time::Bool)</code></pre><p>Perform prolongation from a coarse grid (<code>l-1</code>) to a fine grid (<code>l</code>). This function fills the ghost cells of the fine grid by interpolating the data from the coarse grid in space and, optionally, in time.</p><p><strong>Arguments</strong></p><ul><li><code>grid::Grid</code>: The grid structure.</li><li><code>l::Int</code>: The fine level index.</li><li><code>interp_in_time::Bool</code>: Whether to use time interpolation.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/prolongation.jl#L377-L388">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.prolongate_mongwane!-Tuple{Grid, Int64, Bool}" href="#FixedMeshRefinement.prolongate_mongwane!-Tuple{Grid, Int64, Bool}"><code>FixedMeshRefinement.prolongate_mongwane!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prolongate_mongwane!(grid::Grid, l::Int, interp_in_time::Bool)</code></pre><p>Perform prolongation from a coarse grid (<code>l-1</code>) to a fine grid (<code>l</code>) using Mongwane&#39;s subcycling-in-time method. This is used to set the ghost cell data for the fine grid when subcycling is enabled.</p><p><strong>Arguments</strong></p><ul><li><code>grid::Grid</code>: The grid structure.</li><li><code>l::Int</code>: The fine level index.</li><li><code>interp_in_time::Bool</code>: Whether to use time interpolation for the coarse grid state.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/prolongation.jl#L287-L298">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.restrict_injection!-Tuple{Grid, Int64}" href="#FixedMeshRefinement.restrict_injection!-Tuple{Grid, Int64}"><code>FixedMeshRefinement.restrict_injection!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">restrict_injection!(grid::Grid, l::Int; apply_trans_zone=false)</code></pre><p>Perform restriction from a fine grid (<code>l+1</code>) to a coarse grid (<code>l</code>). This operation transfers data from a finer grid to a coarser grid. Currently, it uses injection by taking the values from the fine grid at the locations corresponding to the coarse grid points.</p><p><strong>Arguments</strong></p><ul><li><code>grid::Grid</code>: The grid structure.</li><li><code>l::Int</code>: The coarse level index.</li><li><code>apply_trans_zone::Bool</code>: If <code>true</code>, the restriction is only applied outside of the transition zones. Defaults to <code>false</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/restriction.jl#L3-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.rk4!-Tuple{Level, Function, Any}" href="#FixedMeshRefinement.rk4!-Tuple{Level, Function, Any}"><code>FixedMeshRefinement.rk4!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rk4!(level::Level, f::Function, p; mongwane::Bool=false)</code></pre><p>Perform a single step of the classic 4th-order Runge-Kutta (RK4) method on a given <code>level</code>. It advances the solution by one time step <code>dt</code>.</p><p><strong>Arguments</strong></p><ul><li><code>level::Level</code>: The grid level to be updated.</li><li><code>f::Function</code>: The function that computes the right-hand side of the ODEs. It should have the signature <code>f(level, k, u, p, t)</code>.</li><li><code>p</code>: Parameters to be passed to the RHS function <code>f</code>.</li><li><code>mongwane::Bool</code>: If <code>true</code>, enables special buffer filling for Mongwane&#39;s subcycling method. Defaults to <code>false</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/rk.jl#L39-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.rk4_dense_output_y!-NTuple{5, Any}" href="#FixedMeshRefinement.rk4_dense_output_y!-NTuple{5, Any}"><code>FixedMeshRefinement.rk4_dense_output_y!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rk4_dense_output_y!(y, theta, h, yn, k)</code></pre><p>Calculate the dense output for a 4th-order Runge-Kutta method at a fractional time <code>theta</code> within a time step <code>h</code>. This is used for interpolation in time within a single time step.</p><p><strong>Arguments</strong></p><ul><li><code>y</code>: The output array for the interpolated state.</li><li><code>theta::Float64</code>: The fractional time within the interval <code>[0, 1]</code>.</li><li><code>h::Float64</code>: The time step size.</li><li><code>yn</code>: The state at the beginning of the time step.</li><li><code>k</code>: A vector of RK4 stages <code>k1</code> through <code>k4</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/prolongation.jl#L66-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.searchsortednearest-Tuple{AbstractVector, Any}" href="#FixedMeshRefinement.searchsortednearest-Tuple{AbstractVector, Any}"><code>FixedMeshRefinement.searchsortednearest</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">searchsortednearest(a::AbstractVector, x)</code></pre><p>Find the index of the element in a sorted array <code>a</code> that is nearest to <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/grid.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.shift_grid_boundaries!-Tuple{Grid, Tuple{Int64, Int64}}" href="#FixedMeshRefinement.shift_grid_boundaries!-Tuple{Grid, Tuple{Int64, Int64}}"><code>FixedMeshRefinement.shift_grid_boundaries!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">shift_grid_boundaries!(grid::Grid, num_shift_points::NTuple{2,Int}; func_fill_extended::Function=fill_extended_grid_extrapolate!)</code></pre><p>Shift the boundary of the grid by a given number of points; as a prerequisite, all levels must align with the physical boundary. If the number of shift points is positive, the grid will be extended, otherwise it will be shrunk. The tuple <code>num_shift_points</code> is the number of points to shift on the left and right boundaries, respectively.</p><p><strong>Arguments</strong></p><ul><li><code>grid::Grid</code>: The grid to shift boundaries of</li><li><code>num_shift_points::NTuple{2,Int}</code>: Number of points to shift on left and right boundaries</li><li><code>func_fill_extended::Function=fill_extended_grid_extrapolate!</code>: Function to compute fill values, takes index and level as arguments</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/excision.jl#L184-L195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.shift_level_boundaries!-Tuple{Grid, Int64, Tuple{Int64, Int64}}" href="#FixedMeshRefinement.shift_level_boundaries!-Tuple{Grid, Int64, Tuple{Int64, Int64}}"><code>FixedMeshRefinement.shift_level_boundaries!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">shift_level_boundaries!(level::Level, num_shift_points::NTuple{2,Int}; func_fill_extended::Function=fill_extended_grid_extrapolate!)</code></pre><p>Shift the boundary of a <code>Level</code> by a given number of points, as a prerequisite, the level must align with the physical boundary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/excision.jl#L55-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.spatial_interpolate!-NTuple{4, Any}" href="#FixedMeshRefinement.spatial_interpolate!-NTuple{4, Any}"><code>FixedMeshRefinement.spatial_interpolate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spatial_interpolate!(res, u, i, order)</code></pre><p>Performs spatial interpolation for prolongation using a set of predefined stencils of a given <code>order</code>. The result is stored in <code>res</code>. The interpolation uses values from <code>u</code> around index <code>i</code>.</p><p><strong>Arguments</strong></p><ul><li><code>res</code>: The destination array for the interpolated values.</li><li><code>u</code>: The source data array.</li><li><code>i::Int</code>: The index in <code>u</code> to center the interpolation stencil.</li><li><code>order::Int</code>: The order of spatial interpolation (1 through 5 are supported).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/prolongation.jl#L3-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.step!-Tuple{Grid, Function, Any}" href="#FixedMeshRefinement.step!-Tuple{Grid, Function, Any}"><code>FixedMeshRefinement.step!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">step!(
    grid::Grid,
    f::Function,
    p;
    mongwane::Bool=false,
    apply_trans_zone::Bool=false,
)</code></pre><p>Advance the solution on the entire <code>grid</code> by one time step of the coarsest level. This function orchestrates the time stepping across all refinement levels, handling subcycling, prolongation, restriction, and application of transition zones.</p><p><strong>Arguments</strong></p><ul><li><code>grid::Grid</code>: The FMR grid structure.</li><li><code>f::Function</code>: The function that computes the right-hand side of the ODEs. It should have the signature <code>f(level, k, u, p, t)</code>.</li><li><code>p</code>: Parameters to be passed to the RHS function <code>f</code>.</li><li><code>mongwane::Bool</code>: If <code>true</code>, enables Mongwane&#39;s subcycling method. Defaults to <code>false</code>.</li><li><code>apply_trans_zone::Bool</code>: If <code>true</code>, applies transition zones to smooth inter-grid boundaries. Defaults to <code>false</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/step.jl#L3-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.time_interpolate!-Tuple{Any, Any, Any}" href="#FixedMeshRefinement.time_interpolate!-Tuple{Any, Any, Any}"><code>FixedMeshRefinement.time_interpolate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">time_interpolate!(res, u, order)</code></pre><p>Performs time interpolation for prolongation. <code>u</code> should be ordered from oldest to newest. The result is stored in <code>res</code>.</p><p><strong>Arguments</strong></p><ul><li><code>res</code>: The destination array for the interpolated values.</li><li><code>u</code>: A vector of states at different time levels, ordered from oldest to newest.</li><li><code>order::Int</code>: The order of time interpolation (1 through 4 are supported).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/prolongation.jl#L41-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.transition_profile-Tuple{Any, Any, Any}" href="#FixedMeshRefinement.transition_profile-Tuple{Any, Any, Any}"><code>FixedMeshRefinement.transition_profile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transition_profile(xl, xh, x; type=1)</code></pre><p>Compute a transition profile value at <code>x</code> between <code>xl</code> and <code>xh</code>. This is used to smoothly blend solutions in transition zones.</p><p><strong>Arguments</strong></p><ul><li><code>xl::Float64</code>: The lower bound of the transition interval.</li><li><code>xh::Float64</code>: The upper bound of the transition interval.</li><li><code>x::Float64</code>: The point at which to evaluate the profile.</li><li><code>type::Int</code>: The type of transition profile (1: boxstep, 2: smoothstep, 3: smootherstep).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/prolongation.jl#L149-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FixedMeshRefinement.typetol-Tuple{Type{&lt;:AbstractFloat}}" href="#FixedMeshRefinement.typetol-Tuple{Type{&lt;:AbstractFloat}}"><code>FixedMeshRefinement.typetol</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">typetol(TF::Type{&lt;:AbstractFloat})</code></pre><p>Return a tolerance value for a given float type <code>TF</code>. The tolerance is calculated as <code>eps(TF)^(4/5)</code>. This is useful for setting default tolerances in numerical algorithms where machine precision is a factor.</p><p><strong>Arguments</strong></p><ul><li><code>TF::Type{&lt;:AbstractFloat}</code>: The floating point type.</li></ul><p><strong>Returns</strong></p><ul><li>A tolerance value of the same floating point type.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; typetol(Float64)
3.666852862501036e-11

julia&gt; typetol(Float32)
2.422181f-5</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/AuroraDysis/FixedMeshRefinement.jl/blob/a9cff125a3658ba00e628f0382dd3f5b4b670a1f/src/utils.jl#L3-L24">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Tuesday 8 July 2025 13:39">Tuesday 8 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
